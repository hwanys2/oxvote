{% extends 'voting/base.html' %}

{% block title %}{{ question.text|truncatechars:30 }}{% endblock %}

{% block content %}
<div class="vote-container">
    <div class="question-section">
        <h1 class="vote-question">{{ question.text }}</h1>
        <p class="question-description">자유롭게 답변을 입력하세요. 여러 번 제출할 수 있습니다.</p>
    </div>
    
    <div class="voting-section">
        <form method="post" class="answer-form">
            {% csrf_token %}
            <div class="answer-input-group">
                <textarea 
                    class="answer-input" 
                    name="response" 
                    placeholder="답변을 입력하세요 (최대 200자)"
                    maxlength="200"
                    rows="3"
                    required
                ></textarea>
                <div class="char-count">
                    <span id="charCount">0</span> / 200
                </div>
                <button type="submit" class="submit-answer-btn">
                    <i class="fas fa-paper-plane"></i>
                    제출하기
                </button>
            </div>
        </form>
        
        {% if user_response_count > 0 %}
        <div class="user-stats">
            <i class="fas fa-check-circle"></i>
            내가 제출한 답변: <strong>{{ user_response_count }}개</strong>
        </div>
        {% endif %}
    </div>
</div>

<style>
.vote-container {
    min-height: 100vh;
    background: #fafafa;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 20px;
    gap: 30px;
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
}

.question-section {
    text-align: center;
    max-width: 800px;
}

.vote-question {
    font-size: 2.2rem;
    font-weight: 700;
    color: #1a1a1a;
    margin: 0 0 15px 0;
    line-height: 1.3;
}

.question-description {
    font-size: 1rem;
    color: #5f6368;
    margin: 0;
}

.voting-section {
    width: 100%;
    max-width: 600px;
    display: flex;
    flex-direction: column;
    gap: 20px;
}

.answer-form {
    width: 100%;
}

.answer-input-group {
    background: white;
    border-radius: 20px;
    padding: 30px;
    box-shadow: 0 8px 24px rgba(0,0,0,0.1);
    border: 2px solid #e8eaed;
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.answer-input {
    width: 100%;
    padding: 15px;
    font-size: 16px;
    border: 2px solid #e8eaed;
    border-radius: 12px;
    resize: vertical;
    min-height: 100px;
    font-family: inherit;
    transition: all 0.3s ease;
    outline: none;
}

.answer-input:focus {
    border-color: #4285f4;
    box-shadow: 0 0 0 3px rgba(66, 133, 244, 0.1);
}

.char-count {
    text-align: right;
    font-size: 14px;
    color: #5f6368;
}

.submit-answer-btn {
    background: linear-gradient(135deg, #4285f4 0%, #3367d6 100%);
    color: white;
    border: none;
    border-radius: 50px;
    padding: 16px 32px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    transition: all 0.3s ease;
    box-shadow: 0 4px 12px rgba(66, 133, 244, 0.3);
}

.submit-answer-btn:hover {
    background: linear-gradient(135deg, #3367d6 0%, #2851a3 100%);
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(66, 133, 244, 0.4);
}

.submit-answer-btn:active {
    transform: translateY(0);
}

.user-stats {
    background: #e8f5e9;
    border: 2px solid #4caf50;
    border-radius: 12px;
    padding: 15px 20px;
    text-align: center;
    color: #2e7d32;
    font-size: 15px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
}

.user-stats i {
    font-size: 18px;
}

@media (max-width: 768px) {
    .vote-question {
        font-size: 1.6rem;
    }
    
    .question-description {
        font-size: 0.9rem;
    }
    
    .answer-input-group {
        padding: 20px;
    }
    
    .answer-input {
        min-height: 80px;
        font-size: 15px;
    }
    
    .submit-answer-btn {
        padding: 14px 28px;
        font-size: 15px;
    }
}
</style>

<script>
const answerInput = document.querySelector('.answer-input');
const charCount = document.getElementById('charCount');

answerInput.addEventListener('input', function() {
    charCount.textContent = this.value.length;
    
    // 글자 수에 따라 색상 변경
    if (this.value.length > 180) {
        charCount.style.color = '#ea4335';
    } else if (this.value.length > 150) {
        charCount.style.color = '#fbbc04';
    } else {
        charCount.style.color = '#5f6368';
    }
});
</script>
{% endblock %}
